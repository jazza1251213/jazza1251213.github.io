<!DOCTYPE html>
<html>
  <head>
    <title>SWATNEO</title>
    <script>
      // 新しい配列を作成
      const AnswerArray = [];
      const QuestionArray = [];
      const ExplainArray = [];

      function getRandomInt(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
      }

      let AnswerText, QuestionText, ExplainText;

      const AnswerFile = 'ans.txt';
      fetch(AnswerFile)
        .then(response => {
          if (!response.ok) {
            throw new Error('ネットワークの応答が問題があります');
          }
          return response.text();
        })
        .then(text => {
          AnswerText = text.split('\n');
          prepareData();
        });

      const QuestionFile = 'que.txt';
      fetch(QuestionFile)
        .then(response => {
          if (!response.ok) {
            throw new Error('ネットワークの応答が問題があります');
          }
          return response.text();
        })
        .then(text => {
          QuestionText = text.split('\n');
          prepareData();
        });

      const ExplainFile = 'exp.txt';
      fetch(ExplainFile)
        .then(response => {
          if (!response.ok) {
            throw new Error('ネットワークの応答が問題があります');
          }
          return response.text();
        })
        .then(text => {
          ExplainText = text.split('\n');
          prepareData();
        });

      function prepareData() {
        if (AnswerText && QuestionText && ExplainText) {
          for (let i = 0; i < 2; i++) {
            const Random = getRandomInt(0, AnswerText.length - 1);

            AnswerArray.push(AnswerText[Random]);
            QuestionArray.push(QuestionText[Random]);
            ExplainArray.push(ExplainText[Random]);

            AnswerText.splice(Random, 1);
            QuestionText.splice(Random, 1);
            ExplainText.splice(Random, 1);
          }
          displayQuestion(0);
        }
      }

      function displayQuestion(index) {
        let correctAnswer = AnswerArray[index];

        document.getElementById("Question").textContent = "問題：" + QuestionArray[index];
        document.getElementById("Explain").textContent = "解説：" + ExplainArray[index];
        document.getElementById("Explain").style.display = "none";

        function checkAnswer() {
          const UserAnswer = document.getElementById("UserAnswer").value;
          const resultElement = document.getElementById("Result");
          resultElement.textContent = (UserAnswer === correctAnswer) ? "正解" : "不正解";
          document.getElementById("Explain").style.display = "block";
        }

        document.getElementById("CheckAnswer").onclick = checkAnswer;

        document.getElementById("NextQuestion").onclick = function() {
          if (index + 1 < 2) {
            displayQuestion(index + 1);
          }
        };
      }
    </script>
  </head>
  <body>
    <h1>SWATNEO</h1>
    <label id="Question"></label>
    <br><br>
    <input type="text" id="UserAnswer" />
    <button id="CheckAnswer">解答する</button>
    <p id="Result"></p>
    <p id="Explain"></p>
    <button id="NextQuestion">次の問題</button>
  </body>
</html>
